{
  "database": {
    "type": "serverless_json",
    "description": "Configuração para banco de dados serverless usando JSON",
    "storage_provider": "vercel_kv",
    "backup_enabled": true,
    "backup_frequency": "daily"
  },
  "tables": {
    "midia_df": {
      "description": "Tabela principal de itens de mídia processados",
      "primary_key": "id",
      "indexes": ["candidato", "data_publicacao", "fonte"],
      "schema": {
        "id": {"type": "string", "required": true, "unique": true},
        "candidato": {"type": "string", "required": true},
        "fonte": {"type": "string", "required": true},
        "url": {"type": "string", "required": true},
        "tipo": {"type": "string", "enum": ["noticia", "artigo", "entrevista", "video", "post"]},
        "titulo": {"type": "string", "required": true},
        "data_publicacao": {"type": "date", "required": true},
        "texto": {"type": "text"},
        "resumo": {"type": "text", "max_length": 500},
        "score_credibilidade": {"type": "float", "min": 0, "max": 1},
        "tema": {"type": "array", "items": {"type": "string"}},
        "sentimento": {"type": "float", "min": -1, "max": 1},
        "retorica": {"type": "string", "enum": ["proposta", "ataque", "defesa", "neutra"]},
        "alvo": {"type": "string", "enum": ["auto", "adversario", "instituicao", "eleitorado"]},
        "origem_coleta": {"type": "string", "required": true}
      }
    },
    "pesquisas_df": {
      "description": "Tabela de pesquisas eleitorais",
      "primary_key": "id",
      "indexes": ["instituto", "data_campo"],
      "schema": {
        "id": {"type": "string", "required": true, "unique": true},
        "instituto": {"type": "string", "required": true},
        "local": {"type": "string", "default": "Distrito Federal"},
        "data_campo": {"type": "date", "required": true},
        "amostra": {"type": "integer", "min": 1},
        "margem": {"type": "float", "min": 0},
        "metodologia": {"type": "string"},
        "cenario": {"type": "string", "enum": ["espontaneo", "estimulado"]},
        "resultado_json": {"type": "object", "required": true},
        "fonte_url": {"type": "string"},
        "confiabilidade_baixa": {"type": "boolean", "default": false}
      }
    },
    "alertas": {
      "description": "Tabela de alertas do sistema",
      "primary_key": "id",
      "indexes": ["candidato", "tipo", "timestamp"],
      "schema": {
        "id": {"type": "string", "required": true, "unique": true},
        "tipo": {"type": "string", "required": true},
        "candidato": {"type": "string", "required": true},
        "severidade": {"type": "string", "enum": ["baixa", "media", "alta", "info"]},
        "titulo": {"type": "string", "required": true},
        "mensagem": {"type": "text", "required": true},
        "detalhes": {"type": "object"},
        "timestamp": {"type": "datetime", "required": true},
        "lido": {"type": "boolean", "default": false},
        "acao_sugerida": {"type": "text"}
      }
    },
    "configuracao": {
      "description": "Tabela de configurações do sistema",
      "primary_key": "chave",
      "schema": {
        "chave": {"type": "string", "required": true, "unique": true},
        "valor": {"type": "object", "required": true},
        "descricao": {"type": "string"},
        "ultima_atualizacao": {"type": "datetime", "required": true}
      }
    }
  },
  "views": {
    "sov_semanal": {
      "description": "View materializada de Share of Voice semanal",
      "refresh_frequency": "hourly",
      "depends_on": ["midia_df"],
      "columns": ["candidato", "semana", "tema_flat", "mentions_candidato_tema"]
    },
    "sov_normalizado": {
      "description": "View materializada de Share of Voice normalizado",
      "refresh_frequency": "hourly",
      "depends_on": ["sov_semanal", "sov_total_tema"],
      "columns": ["candidato", "semana", "tema", "sov"]
    },
    "retorica_14d": {
      "description": "View de análise retórica dos últimos 14 dias",
      "refresh_frequency": "daily",
      "depends_on": ["midia_df"],
      "columns": ["candidato", "retorica", "pct"]
    },
    "risco_negativo_7d": {
      "description": "View de risco de imagem negativo dos últimos 7 dias",
      "refresh_frequency": "hourly",
      "depends_on": ["midia_df"],
      "columns": ["candidato", "men_negativas_alc", "ultima_mencao"]
    },
    "pesquisas_30d_flat": {
      "description": "View flat de pesquisas dos últimos 30 dias",
      "refresh_frequency": "daily",
      "depends_on": ["pesquisas_df"],
      "columns": ["data_campo", "instituto", "cenario", "candidato", "intencao"]
    }
  },
  "data_retention": {
    "midia_df": "365 days",
    "pesquisas_df": "unlimited",
    "alertas": "90 days",
    "configuracao": "unlimited"
  },
  "backup_config": {
    "enabled": true,
    "frequency": "daily",
    "retention": "30 days",
    "storage": "vercel_blob",
    "compression": true,
    "encryption": false
  },
  "performance": {
    "cache_ttl": 300,
    "max_query_results": 1000,
    "pagination_size": 50,
    "timeout": 30
  },
  "monitoring": {
    "log_queries": true,
    "log_slow_queries": true,
    "slow_query_threshold": 5,
    "alert_on_errors": true
  }
}

